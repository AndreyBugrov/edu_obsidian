Эгамов в третьем классе нашёл формулу Фибоначчи, а через 4 года вывел сам. В библиотеке всегда "было, что почитать".
# Разностные производные
$U(x)$ можно аппроксимировать сеточной функцией $y(x_i)$.
Сеточная функция: $x_0, x_1$ и т.д. Если брать ещё и игреки, то точно сетка. Пусть $x_i-x_{i-1}=h=const$. Тогда заменим  $U(x)$ на $y(x_i)$, причём $U(x)= y(x_i) = y_i$
![[Pasted image 20230303092736.png]]
Но мы не можем подойти к точке ближе, чем на h. Поэтому разумно рассмотреть ближайшие точки:
$\displaystyle\frac{y_{i+1}-y_i}{h}$ - но насколько близкая аппроксимация?
$y(x_{i+1}) = U(x)= U_i+U(x_i)(x_{i+1}-x_i)+U(\xi_i)(x_{i+1}-x_i)$
$y_{i+1}=y_i+y^{'}_i h+C_2*h^2$, $C_2=\displaystyle\frac{y^n(\xi)}{2}$
![[Pasted image 20230303093325.png]]
где M2 - максимум модуля второй производной, делённый на 2.
Когда подставляем в уравнение разностную проивзодную, мы подставляем некое выражение ($y^{'}_i+C_2*h$). Если же мы подходили справа: $y_{i-1}=y_i-y^{'}_ih+b_2h^2$
$\displaystyle\frac{y_i-y_{i-1}}{h}=y^{'}_i-b_2h$ - т.е. первая разностная производная с погрешностью второго порядка. Но можно ли написать второго порядка? Оказывается, да.
$y_{i+1}=y_i+y^{'}_ih+\displaystyle\frac{y^{''}h^2}{2}+\displaystyle\frac{y^{'''}h^3}{6}+\displaystyle\frac{U^{IV}(\xi)h^4}{24}$
![[Pasted image 20230303094219.png]]
Вычтем из $\displaystyle\frac{y_{i+1}-y_{i-1}}{2h} = y^{'}_i + \displaystyle\frac{y^{'''}_ih^2}{6} +A_4h^3$
Получаем, что добавка - $O(h^2)$, т.е. это первая производная с погрешностью второго порядка. Тогда возникает мысль аппроксимации прозводной любого порядка:
$y^{'}_i=\displaystyle\frac{1}{h}\displaystyle\sum_{j=i_0}^{I_0} c_iy_j$
Сначала мы брали для левой производной i и i+1, для правой i-1 и i, для центральной i-1, i, i+1. Но могли пойти i, i+1, i+2. Могли идти и от i-2. Поэтому $i_0$ - начальная точка, $I_0$ - конечная точка. Чем больше точек, тем лучше можно аппроксимировать.
На каждом этапе нужно следить за тем, чтобы погрешность была одна и та же. Иначе общая погрешность будет считаться по наибольшей погрешности. В этом случае не будет смысла решать с погрешностью второго задача, если где-то есть первого.
Пусть дана краевая задача: ![[Pasted image 20230303095247.png]] - найти все $c_i$. Для этого распишем по формуле Тейлора для $y_1, y_2$ вплоть до третьего порядка. 
![[Pasted image 20230303095447.png]]
![[Pasted image 20230303100451.png]]
Чтобы получилось равенство, первая скобка должна занулиться, вторая равна 1, третья занулиться. Это согласно методу неопр коэф-тов, ведь слева стоит только $y^{'}_0$. Получаем ![[Pasted image 20230303100718.png]]
Найдём для другой производной:
![[Pasted image 20230303101121.png]]
![[Pasted image 20230303101638.png]]
Четвёртая скобка занулилась, так как это как вторая, только делённая на 6.
![[Pasted image 20230303101746.png]]
$C_{i-1}=1, C_i=-2$, получим:
$y^{''}_i \approx \displaystyle\frac{y_{i+1}-2y_i+y_{i-1}}{h^2}$ - погрешность второго порядка
ДЗ:
Проверить ![[Pasted image 20230303102107.png]] - это правая разност пр-дная 2 пор с погреш 1 пор. 
Потом сделать раз пр-дную с погрешностью 3-го порядка.
## Дифуры
$y^{''}+y^{'}+2y=0, y_0=1, y^{'}_0=0$. 

